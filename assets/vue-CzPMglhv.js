var G=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var L=(d,m)=>{var b={};for(var c in d)ee.call(d,c)&&m.indexOf(c)<0&&(b[c]=d[c]);if(d!=null&&G)for(var c of G(d))m.indexOf(c)<0&&te.call(d,c)&&(b[c]=d[c]);return b};import{r as H,b as re,w as oe,x as ne,Q as se}from"./index-DYxrg3UW.js";var ae=Object.create,X=Object.defineProperty,ie=Object.getOwnPropertyDescriptor,le=Object.getOwnPropertyNames,ce=Object.getPrototypeOf,de=Object.prototype.hasOwnProperty,ue=(d,m)=>()=>(m||d((m={exports:{}}).exports,m),m.exports),pe=(d,m,b,c)=>{if(m&&typeof m=="object"||typeof m=="function")for(let P of le(m))!de.call(d,P)&&P!==b&&X(d,P,{get:()=>m[P],enumerable:!(c=ie(m,P))||c.enumerable});return d},he=(d,m,b)=>(b=d!=null?ae(ce(d)):{},pe(!d||!d.__esModule?X(b,"default",{value:d,enumerable:!0}):b,d)),fe=ue((d,m)=>{var b=(function(){var c=String.fromCharCode,P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",S={};function u(e,o){if(!S[e]){S[e]={};for(var l=0;l<e.length;l++)S[e][e.charAt(l)]=l}return S[e][o]}var C={compressToBase64:function(e){if(e==null)return"";var o=C._compress(e,6,function(l){return P.charAt(l)});switch(o.length%4){default:case 0:return o;case 1:return o+"===";case 2:return o+"==";case 3:return o+"="}},decompressFromBase64:function(e){return e==null?"":e==""?null:C._decompress(e.length,32,function(o){return u(P,e.charAt(o))})},compressToUTF16:function(e){return e==null?"":C._compress(e,15,function(o){return c(o+32)})+" "},decompressFromUTF16:function(e){return e==null?"":e==""?null:C._decompress(e.length,16384,function(o){return e.charCodeAt(o)-32})},compressToUint8Array:function(e){for(var o=C.compress(e),l=new Uint8Array(o.length*2),n=0,r=o.length;n<r;n++){var h=o.charCodeAt(n);l[n*2]=h>>>8,l[n*2+1]=h%256}return l},decompressFromUint8Array:function(e){if(e==null)return C.decompress(e);for(var o=new Array(e.length/2),l=0,n=o.length;l<n;l++)o[l]=e[l*2]*256+e[l*2+1];var r=[];return o.forEach(function(h){r.push(c(h))}),C.decompress(r.join(""))},compressToEncodedURIComponent:function(e){return e==null?"":C._compress(e,6,function(o){return N.charAt(o)})},decompressFromEncodedURIComponent:function(e){return e==null?"":e==""?null:(e=e.replace(/ /g,"+"),C._decompress(e.length,32,function(o){return u(N,e.charAt(o))}))},compress:function(e){return C._compress(e,16,function(o){return c(o)})},_compress:function(e,o,l){if(e==null)return"";var n,r,h={},x={},O="",A="",g="",v=2,f=3,p=2,y=[],t=0,i=0,a;for(a=0;a<e.length;a+=1)if(O=e.charAt(a),Object.prototype.hasOwnProperty.call(h,O)||(h[O]=f++,x[O]=!0),A=g+O,Object.prototype.hasOwnProperty.call(h,A))g=A;else{if(Object.prototype.hasOwnProperty.call(x,g)){if(g.charCodeAt(0)<256){for(n=0;n<p;n++)t=t<<1,i==o-1?(i=0,y.push(l(t)),t=0):i++;for(r=g.charCodeAt(0),n=0;n<8;n++)t=t<<1|r&1,i==o-1?(i=0,y.push(l(t)),t=0):i++,r=r>>1}else{for(r=1,n=0;n<p;n++)t=t<<1|r,i==o-1?(i=0,y.push(l(t)),t=0):i++,r=0;for(r=g.charCodeAt(0),n=0;n<16;n++)t=t<<1|r&1,i==o-1?(i=0,y.push(l(t)),t=0):i++,r=r>>1}v--,v==0&&(v=Math.pow(2,p),p++),delete x[g]}else for(r=h[g],n=0;n<p;n++)t=t<<1|r&1,i==o-1?(i=0,y.push(l(t)),t=0):i++,r=r>>1;v--,v==0&&(v=Math.pow(2,p),p++),h[A]=f++,g=String(O)}if(g!==""){if(Object.prototype.hasOwnProperty.call(x,g)){if(g.charCodeAt(0)<256){for(n=0;n<p;n++)t=t<<1,i==o-1?(i=0,y.push(l(t)),t=0):i++;for(r=g.charCodeAt(0),n=0;n<8;n++)t=t<<1|r&1,i==o-1?(i=0,y.push(l(t)),t=0):i++,r=r>>1}else{for(r=1,n=0;n<p;n++)t=t<<1|r,i==o-1?(i=0,y.push(l(t)),t=0):i++,r=0;for(r=g.charCodeAt(0),n=0;n<16;n++)t=t<<1|r&1,i==o-1?(i=0,y.push(l(t)),t=0):i++,r=r>>1}v--,v==0&&(v=Math.pow(2,p),p++),delete x[g]}else for(r=h[g],n=0;n<p;n++)t=t<<1|r&1,i==o-1?(i=0,y.push(l(t)),t=0):i++,r=r>>1;v--,v==0&&(v=Math.pow(2,p),p++)}for(r=2,n=0;n<p;n++)t=t<<1|r&1,i==o-1?(i=0,y.push(l(t)),t=0):i++,r=r>>1;for(;;)if(t=t<<1,i==o-1){y.push(l(t));break}else i++;return y.join("")},decompress:function(e){return e==null?"":e==""?null:C._decompress(e.length,32768,function(o){return e.charCodeAt(o)})},_decompress:function(e,o,l){var n=[],r=4,h=4,x=3,O="",A=[],g,v,f,p,y,t,i,a={val:l(0),position:o,index:1};for(g=0;g<3;g+=1)n[g]=g;for(f=0,y=Math.pow(2,2),t=1;t!=y;)p=a.val&a.position,a.position>>=1,a.position==0&&(a.position=o,a.val=l(a.index++)),f|=(p>0?1:0)*t,t<<=1;switch(f){case 0:for(f=0,y=Math.pow(2,8),t=1;t!=y;)p=a.val&a.position,a.position>>=1,a.position==0&&(a.position=o,a.val=l(a.index++)),f|=(p>0?1:0)*t,t<<=1;i=c(f);break;case 1:for(f=0,y=Math.pow(2,16),t=1;t!=y;)p=a.val&a.position,a.position>>=1,a.position==0&&(a.position=o,a.val=l(a.index++)),f|=(p>0?1:0)*t,t<<=1;i=c(f);break;case 2:return""}for(n[3]=i,v=i,A.push(i);;){if(a.index>e)return"";for(f=0,y=Math.pow(2,x),t=1;t!=y;)p=a.val&a.position,a.position>>=1,a.position==0&&(a.position=o,a.val=l(a.index++)),f|=(p>0?1:0)*t,t<<=1;switch(i=f){case 0:for(f=0,y=Math.pow(2,8),t=1;t!=y;)p=a.val&a.position,a.position>>=1,a.position==0&&(a.position=o,a.val=l(a.index++)),f|=(p>0?1:0)*t,t<<=1;n[h++]=c(f),i=h-1,r--;break;case 1:for(f=0,y=Math.pow(2,16),t=1;t!=y;)p=a.val&a.position,a.position>>=1,a.position==0&&(a.position=o,a.val=l(a.index++)),f|=(p>0?1:0)*t,t<<=1;n[h++]=c(f),i=h-1,r--;break;case 2:return A.join("")}if(r==0&&(r=Math.pow(2,x),x++),n[i])O=n[i];else if(i===h)O=v+v.charAt(0);else return null;A.push(O),n[h++]=v+O.charAt(0),r--,v=O,r==0&&(r=Math.pow(2,x),x++)}}};return C})();typeof m!="undefined"&&m!=null&&(m.exports=b)}),Q=he(fe());async function K(d,m={}){typeof d=="object"&&!(d instanceof HTMLElement)&&(d.headless||d.view==="headless")&&(m=d,d=null);let{config:b={},headless:c,loading:P="lazy",view:N}=m,S=c||N==="headless",u=null,C=null;if(typeof d=="string")u=document.querySelector(d);else if(d instanceof HTMLElement)u=d;else if(!(S&&typeof d=="object"))throw new Error("A valid container element is required.");if(!u)if(S)u=document.createElement("div"),B(u),document.body.appendChild(u);else throw new Error(`Cannot find element: "${d}"`);let e=new URL(ve(m)),o=e.origin;e.searchParams.set("embed","true"),e.searchParams.set("loading",S?"eager":P),e.searchParams.set("sdkVersion","0.12.0"),typeof b=="object"&&Object.keys(b).length>0&&e.searchParams.set("config","sdk");let l=m.params;typeof l=="object"&&Object.keys(l).length>0&&JSON.stringify(l).length<1800&&Object.keys(l).forEach(s=>{e.searchParams.set(s,encodeURIComponent(String(l[s])))});let n=!1,r="Cannot call API methods after calling `destroy()`.",h=[],x=(s,w="message")=>{addEventListener(w,s),h.push(s)},O=await new Promise(s=>{var w,E,U,k,M,J,R,F,W;if(!u)return;let I=u.dataset.height||u.style.height;if(I&&!S){let z=isNaN(Number(I))?I:I+"px";u.style.height=z}u.dataset.defaultStyles!=="false"&&!S&&((w=u.style).backgroundColor||(w.backgroundColor="#fff"),(E=u.style).border||(E.border="1px solid black"),(U=u.style).borderRadius||(U.borderRadius="8px"),(k=u.style).boxSizing||(k.boxSizing="border-box"),(M=u.style).padding||(M.padding="0"),(J=u.style).width||(J.width="100%"),(R=u.style).height||(R.height=u.style.height||"300px"),u.style.minHeight="200px",u.style.flexGrow="1",(F=u.style).overflow||(F.overflow="hidden"),(W=u.style).resize||(W.resize="vertical"));let V="livecodes",$=u.querySelector(`iframe.${V}`),j=$||document.createElement("iframe");j.classList.add(V),j.setAttribute("allow","accelerometer; camera; encrypted-media; display-capture; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; web-share"),j.setAttribute("allowtransparency","true"),j.setAttribute("allowpaymentrequest","true"),j.setAttribute("allowfullscreen","true"),j.setAttribute("sandbox","allow-same-origin allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-presentation allow-scripts");let Z=P==="eager"?"eager":"lazy";j.setAttribute("loading",Z),S?B(j):(j.style.height="100%",j.style.minHeight="200px",j.style.width="100%",j.style.margin="0",j.style.border="0",j.style.borderRadius=u.style.borderRadius),x(function z(_){var T;_.source!==j.contentWindow||_.origin!==o||((T=_.data)==null?void 0:T.type)!=="livecodes-init"||(removeEventListener("message",z),C=Number(_.data.payload.appVersion.replace(/^v/,"")))}),(!C||C<46)&&x(function z(_){var T,D;_.source!==j.contentWindow||_.origin!==o||((T=_.data)==null?void 0:T.type)!=="livecodes-get-config"||(removeEventListener("message",z),(D=j.contentWindow)==null||D.postMessage({type:"livecodes-config",payload:b},o))}),j.onload=()=>{s(j)},j.src=e.href,$||u.appendChild(j)}),A=new Promise(s=>{x(function w(E){var U;E.source!==O.contentWindow||E.origin!==o||((U=E.data)==null?void 0:U.type)!=="livecodes-ready"||(removeEventListener("message",w),s(),A.settled=!0)})}),g=()=>n?Promise.reject(r):new Promise(async s=>{var w;A.settled&&s();let E={type:"livecodes-load"};(w=O.contentWindow)==null||w.postMessage(E,o),await A,s()}),v=(s,w)=>new Promise(async(E,U)=>{var k;if(n)return U(r);await g();let M=Y();x(function J(R){var F,W;if(!(R.source!==O.contentWindow||R.origin!==o||((F=R.data)==null?void 0:F.type)!=="livecodes-api-response"||((W=R.data)==null?void 0:W.id)!==M)&&R.data.method===s){removeEventListener("message",J);let I=R.data.payload;I!=null&&I.error?U(I.error):E(I)}}),(k=O.contentWindow)==null||k.postMessage({method:s,id:M,args:w},o)}),f={},p=["load","ready","code","console","tests","destroy"],y=(s,w)=>{var E;if(n)throw new Error(r);return p.includes(s)?(v("watch",[s]),f[s]||(f[s]=[]),(E=f[s])==null||E.push(w),{remove:()=>{var U,k;f[s]=(U=f[s])==null?void 0:U.filter(M=>M!==w),((k=f[s])==null?void 0:k.length)===0&&v("watch",[s,"unsubscribe"])}}):{remove:()=>{}}},t=s=>({"livecodes-app-loaded":"load","livecodes-ready":"ready","livecodes-change":"code","livecodes-console":"console","livecodes-test-results":"tests","livecodes-destroy":"destroy"})[s];x(async function(s){var w,E,U,k;let M=t((E=(w=s.data)==null?void 0:w.type)!=null?E:"");if(s.source!==O.contentWindow||s.origin!==o||!M||!f[M])return;let J=(U=s.data)==null?void 0:U.payload;(k=f[M])==null||k.forEach(R=>{R(J)})});let i=()=>{var s;(s=O==null?void 0:O.remove)==null||s.call(O),Object.values(f).forEach(w=>{w.length=0}),h.forEach(w=>removeEventListener("message",w)),h.length=0,a&&u&&a.unobserve(u),n=!0},a;P==="lazy"&&"IntersectionObserver"in window&&(a=new IntersectionObserver((s,w)=>{s.forEach(async E=>{E.isIntersecting&&(await g(),w.unobserve(u))})},{rootMargin:"150px"}),a.observe(u));function B(s){s.style.position="absolute",s.style.top="0",s.style.visibility="hidden",s.style.opacity="0"}let Y=()=>(String(Math.random())+Date.now().toFixed()).replace("0.","");return{load:()=>g(),run:()=>v("run"),format:s=>v("format",[s]),getShareUrl:s=>v("getShareUrl",[s]),getConfig:s=>v("getConfig",[s]),setConfig:s=>v("setConfig",[s]),getCode:()=>v("getCode"),show:(s,w)=>v("show",[s,w]),runTests:()=>v("runTests"),onChange:s=>y("code",s),watch:y,exec:(s,...w)=>v("exec",[s,...w]),destroy:()=>n?Promise.reject(r):(i(),Promise.resolve())}}function ve(d={}){let n=d,{appUrl:m="https://play.nitrocode.ir",params:b={},config:c={},headless:P,import:N,lite:S,view:u}=n,C=L(n,["appUrl","params","config","headless","import","lite","view"]),e;try{e=new URL(m)}catch(r){throw new Error(`${m} is not a valid URL.`)}let o=new URLSearchParams;Object.entries(C).forEach(([r,h])=>{h!==void 0&&e.searchParams.set(r,String(h))});let l=d.view==="headless"||P;if(S&&(console.warn(`Deprecation notice: "lite" option is deprecated. Use "config: { mode: 'lite' }" instead.`),typeof c=="object"&&c.mode==null?c.mode="lite":e.searchParams.set("lite","true")),u&&(console.warn('Deprecation notice: The "view" option has been moved to "config.view". For headless mode use "headless: true".'),typeof c=="object"&&c.view==null&&u!=="headless"?c.view=u:e.searchParams.set("view",u)),typeof c=="string")try{new URL(c),e.searchParams.set("config",encodeURIComponent(c))}catch(r){throw new Error('"config" is not a valid URL or configuration object.')}else c&&typeof c=="object"&&Object.keys(c).length>0&&(c.title&&c.title!=="Untitled Project"&&e.searchParams.set("title",c.title),c.description&&c.description.length>0&&e.searchParams.set("description",c.description),o.set("config","code/"+(0,Q.compressToEncodedURIComponent)(JSON.stringify(c))));if(b&&typeof b=="object"&&Object.keys(b).length>0)try{o.set("params",(0,Q.compressToEncodedURIComponent)(JSON.stringify(b)))}catch(r){Object.keys(b).forEach(h=>{e.searchParams.set(h,encodeURIComponent(String(b[h])))})}return N&&e.searchParams.set("x",encodeURIComponent(N)),l&&e.searchParams.set("headless","true"),o.toString().length>0&&(e.hash=o.toString()),e.href}var me={appUrl:String,config:[Object,String],headless:Boolean,import:String,lite:Boolean,loading:String,params:Object,template:String,view:String,height:String},q=d=>JSON.parse(JSON.stringify(d)),ge={props:me,emits:["sdkReady"],setup(d,m){let l=d,{height:b}=l,c=L(l,["height"]),P=H(),N=H(b||""),S=H(),n=c,{config:u}=n,C=L(n,["config"]),e=JSON.stringify(u),o=JSON.stringify(C);return re(()=>{P.value&&K(P.value,q(c)).then(r=>{S.value=r,m.emit("sdkReady",r)})}),oe(d,async r=>{var h;if(!P.value||!S.value)return;let v=r,{height:x}=v,O=L(v,["height"]);N.value=x||"";let f=O,{config:A}=f,g=L(f,["config"]);typeof A=="string"&&(A=await fetch(A).then(p=>p.json())),JSON.stringify(g)!==o?(await((h=S.value)==null?void 0:h.destroy()),K(P.value,q(O)).then(p=>{S.value=p,m.emit("sdkReady",p)})):JSON.stringify(A)!==e&&S.value.setConfig(q(A)||{}),e=JSON.stringify(A),o=JSON.stringify(g)}),ne(()=>{var r;(r=S.value)==null||r.destroy()}),()=>{var r,h;return se("div",{ref:P,"data-height":N.value},((h=(r=m.slots).default)==null?void 0:h.call(r))||"")}}},be=ge;export{be as default};
