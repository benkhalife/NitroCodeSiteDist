import{_ as A,r as d,v as g,H as B,b as E,c as f,o as p,d as e,f as h,t as o,q as j,z as b,B as y,n as x,M as z,A as w}from"./index-BtdN3fd9.js";const F={class:"min-h-screen bg-base-200"},V={class:"hero bg-gradient-to-r from-primary to-secondary text-primary-content"},L={class:"hero-content flex-col lg:flex-row-reverse gap-8 p-8"},q={class:"avatar"},H={class:"w-48 rounded-full ring ring-offset-base-100 ring-offset-4 ring-white shadow-2xl relative group"},N=["src"],R={class:"text-center lg:text-right"},T={class:"text-4xl font-bold"},G={class:"text-lg mt-2"},S={class:"badge badge-outline badge-lg mt-2"},J={class:"container mx-auto p-4 max-w-4xl -mt-10"},K={class:"card bg-base-100 shadow-xl"},O={class:"card-body"},Q={class:"flex justify-between items-center mb-6"},W={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},X={class:"stat"},Y={class:"stat-value text-lg"},Z={class:"stat"},$={class:"stat-value text-lg"},ee={class:"stat"},te={class:"stat-value text-lg"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ae={class:"form-control"},oe={class:"form-control"},le={class:"card-actions justify-end mt-6"},ie={key:0,class:"toast toast-top toast-end"},ne={__name:"ActiveUserProfile",setup(re){const a=d({}),l=g({first_name:"",last_name:""}),v=d(B()),n=d(null),u=d(!1),m=d(!1),_=d(null);(async()=>{v.value=await z(),console.log(v.value)})();const i=g({show:!1,message:"",type:"success"}),k=async()=>{try{const s=await w("site/active-user/get-profile");s.ok?a.value=s.profile:r("خطا در دریافت اطلاعات پروفایل","error")}catch(s){r("خطا در ارتباط با سرور","error"),console.error("Error fetching profile:",s)}},I=()=>{l.first_name=a.value.first_name,l.last_name=a.value.last_name,u.value=!0},P=()=>{u.value=!1,n.value=null,n.value},C=()=>{_.value.click()},D=s=>{const t=s.target.files[0];if(t){if(t.size>2*1024*1024){r("حجم عکس نباید بیشتر از 2MB باشد","error");return}n.value=t;const c=new FileReader;c.onload=de=>{},c.readAsDataURL(t)}},M=async()=>{m.value=!0;try{const s=new FormData;s.append("first_name",l.first_name),s.append("last_name",l.last_name),n.value&&s.append("profile_image",n.value);const t=await w("site/active-user/edit-profile",s);t.ok?(a.value=t.profile,u.value=!1,n.value=null,r("پروفایل با موفقیت به‌روزرسانی شد","success")):r(t.message||"خطا در به‌روزرسانی پروفایل","error")}catch(s){r("خطا در ارتباط با سرور","error"),console.error("Error updating profile:",s)}finally{m.value=!1}},r=(s,t="success")=>{i.message=s,i.type=t,i.show=!0,setTimeout(()=>{i.show=!1},3e3)},U=s=>{if(!s)return"";const t=new Date(s);return new Intl.DateTimeFormat("fa-IR",{year:"numeric",month:"long",day:"numeric"}).format(t)};return E(()=>{k()}),(s,t)=>(p(),f("div",F,[e("div",V,[e("div",L,[e("div",q,[e("div",H,[e("img",{src:v.value,alt:"Profile Picture"},null,8,N),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:C},[...t[2]||(t[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])])]),e("input",{ref_key:"fileInput",ref:_,type:"file",class:"hidden",accept:"image/*",onChange:D},null,544)]),e("div",R,[e("h1",T,o(a.value.first_name)+" "+o(a.value.last_name),1),e("p",G,o(a.value.email),1),e("div",S,o(a.value.role),1)])])]),e("div",J,[e("div",K,[e("div",O,[e("div",Q,[t[3]||(t[3]=e("h2",{class:"card-title text-2xl"},"جزئیات پروفایل",-1)),u.value?h("",!0):(p(),f("button",{key:0,class:"btn btn-primary",onClick:I}," ویرایش اطلاعات "))]),u.value?(p(),f("form",{key:1,onSubmit:j(M,["prevent"])},[e("div",se,[e("div",ae,[t[7]||(t[7]=e("label",{class:"label"},[e("span",{class:"label-text"},"نام")],-1)),b(e("input",{type:"text",placeholder:"نام خود را وارد کنید",class:"input input-bordered","onUpdate:modelValue":t[0]||(t[0]=c=>l.first_name=c),required:""},null,512),[[y,l.first_name]])]),e("div",oe,[t[8]||(t[8]=e("label",{class:"label"},[e("span",{class:"label-text"},"نام خانوادگی")],-1)),b(e("input",{type:"text",placeholder:"نام خانوادگی خود را وارد کنید",class:"input input-bordered","onUpdate:modelValue":t[1]||(t[1]=c=>l.last_name=c),required:""},null,512),[[y,l.last_name]])])]),e("div",le,[e("button",{type:"button",class:"btn btn-ghost",onClick:P},"انصراف"),e("button",{type:"submit",class:x(["btn btn-primary",{loading:m.value}])}," ذخیره تغییرات ",2)])],32)):(p(),f("div",W,[e("div",X,[t[4]||(t[4]=e("div",{class:"stat-title"},"نام کامل",-1)),e("div",Y,o(a.value.first_name)+" "+o(a.value.last_name),1)]),e("div",Z,[t[5]||(t[5]=e("div",{class:"stat-title"},"ایمیل",-1)),e("div",$,o(a.value.email),1)]),e("div",ee,[t[6]||(t[6]=e("div",{class:"stat-title"},"تاریخ عضویت",-1)),e("div",te,o(U(a.value.created_at)),1)])]))])])]),i.show?(p(),f("div",ie,[e("div",{class:x(["alert",i.type==="success"?"alert-success":"alert-error"])},[e("span",null,o(i.message),1)],2)])):h("",!0)]))}},fe=A(ne,[["__scopeId","data-v-93ad643a"]]);export{fe as default};
