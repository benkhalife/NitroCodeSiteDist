import{_ as A,r as d,x as y,M as E,b as j,c as i,o as n,d as e,f as v,t as l,m as B,J as x,K as w,n as k,N as F,A as I}from"./index-BkzTegr-.js";import{S as V}from"./sweetalert2.esm.all-NNS-RXd7.js";const z={class:"min-h-screen bg-base-200"},L={class:"hero bg-gradient-to-r from-primary to-secondary text-primary-content"},N={class:"hero-content flex-col lg:flex-row-reverse gap-8 p-8"},R={class:"avatar"},S={class:"w-48 rounded-full ring ring-offset-base-100 ring-offset-4 ring-white shadow-2xl relative group"},q=["src"],H={class:"text-center lg:text-right"},T={class:"text-4xl font-bold"},G={class:"text-lg mt-2"},J={class:"badge badge-outline badge-lg mt-2"},K={class:"container mx-auto p-4 max-w-4xl -mt-10"},O={class:"card bg-base-100 shadow-xl"},Q={class:"card-body"},W={class:"flex justify-between items-center mb-6"},X={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Y={class:"stat"},Z={class:"stat-value text-lg"},$={key:0,class:"stat"},ee={class:"stat-value text-lg"},te={key:1,class:"stat"},se={class:"stat-value text-lg"},ae={class:"stat"},oe={class:"stat-value text-lg"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ie={class:"form-control"},ne={class:"form-control"},re={class:"card-actions justify-end mt-6"},ce={key:0,class:"toast toast-top toast-end"},de={__name:"ActiveUserProfile",setup(ue){const a=d({}),o=y({first_name:"",last_name:""}),f=d(E()),m=d(null),u=d(!1),p=d(!1),g=d(null);(async()=>{f.value=await F(),console.log(f.value)})();const _=y({show:!1,message:"",type:"success"}),h=async()=>{try{const s=await I("site/active-user/get-profile");s.ok?(a.value=s.profile,a.value.first_name.length==0&&b()):r("خطا در دریافت اطلاعات پروفایل","error")}catch(s){r("خطا در ارتباط با سرور","error"),console.error("Error fetching profile:",s)}},b=()=>{o.first_name=a.value.first_name,o.last_name=a.value.last_name,u.value=!0},P=()=>{u.value=!1,m.value=null,m.value},C=()=>{g.value.click()},D=s=>{const t=s.target.files[0];if(t){if(t.size>2*1024*1024){r("حجم عکس نباید بیشتر از 2MB باشد","error");return}m.value=t;const c=new FileReader;c.onload=ve=>{},c.readAsDataURL(t)}},M=async()=>{p.value=!0;try{const s=new FormData;s.append("first_name",o.first_name),s.append("last_name",o.last_name);const t=await I("site/active-user/edit-profile",{first_name:o.first_name,last_name:o.last_name});t.ok?(u.value=!1,m.value=null,r("پروفایل با موفقیت به‌روزرسانی شد","success"),h()):r(t.message||"خطا در به‌روزرسانی پروفایل","error")}catch(s){r("خطا در ارتباط با سرور","error"),console.error("Error updating profile:",s)}finally{p.value=!1}},r=(s,t="success")=>{V.fire({text:s,icon:t})},U=s=>{if(!s)return"";const t=new Date(s);return new Intl.DateTimeFormat("fa-IR",{year:"numeric",month:"long",day:"numeric"}).format(t)};return j(()=>{h()}),(s,t)=>(n(),i("div",z,[e("div",L,[e("div",N,[e("div",R,[e("div",S,[e("img",{src:f.value,alt:"Profile Picture"},null,8,q),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:C},[...t[2]||(t[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])])]),e("input",{ref_key:"fileInput",ref:g,type:"file",class:"hidden",accept:"image/*",onChange:D},null,544)]),e("div",H,[e("h1",T,l(a.value.first_name)+" "+l(a.value.last_name),1),e("p",G,l(a.value.email),1),e("div",J,l(a.value.role),1)])])]),e("div",K,[e("div",O,[e("div",Q,[e("div",W,[t[3]||(t[3]=e("h2",{class:"card-title text-2xl"},"جزئیات پروفایل",-1)),u.value?v("",!0):(n(),i("button",{key:0,class:"btn btn-primary",onClick:b}," ویرایش اطلاعات "))]),u.value?(n(),i("form",{key:1,onSubmit:B(M,["prevent"])},[e("div",le,[e("div",ie,[t[8]||(t[8]=e("label",{class:"label"},[e("span",{class:"label-text"},"نام")],-1)),x(e("input",{type:"text",placeholder:"نام خود را وارد کنید",class:"input input-bordered","onUpdate:modelValue":t[0]||(t[0]=c=>o.first_name=c),required:""},null,512),[[w,o.first_name]])]),e("div",ne,[t[9]||(t[9]=e("label",{class:"label"},[e("span",{class:"label-text"},"نام خانوادگی")],-1)),x(e("input",{type:"text",placeholder:"نام خانوادگی خود را وارد کنید",class:"input input-bordered","onUpdate:modelValue":t[1]||(t[1]=c=>o.last_name=c),required:""},null,512),[[w,o.last_name]])])]),e("div",re,[e("button",{type:"button",class:"btn btn-ghost",onClick:P},"انصراف"),e("button",{type:"submit",class:k(["btn btn-primary",{loading:p.value}])}," ذخیره تغییرات ",2)])],32)):(n(),i("div",X,[e("div",Y,[t[4]||(t[4]=e("div",{class:"stat-title"},"نام کامل",-1)),e("div",Z,l(a.value.first_name)+" "+l(a.value.last_name),1)]),a.value?.mobile?(n(),i("div",$,[t[5]||(t[5]=e("div",{class:"stat-title"},"موبایل",-1)),e("div",ee,l(a.value.mobile),1)])):v("",!0),a.value?.email?(n(),i("div",te,[t[6]||(t[6]=e("div",{class:"stat-title"},"ایمیل",-1)),e("div",se,l(a.value.email),1)])):v("",!0),e("div",ae,[t[7]||(t[7]=e("div",{class:"stat-title"},"تاریخ عضویت",-1)),e("div",oe,l(U(a.value.created_at)),1)])]))])])]),_.show?(n(),i("div",ce,[e("div",{class:k(["alert",_.type==="success"?"alert-success":"alert-error"])},[e("span",null,l(_.message),1)],2)])):v("",!0)]))}},_e=A(de,[["__scopeId","data-v-5d13c624"]]);export{_e as default};
