const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vue-D26iAzpO.js","assets/index-DcsBdKTs.js","assets/index-CDKeHMnE.css"])))=>i.map(i=>d[i]);
import{c as r,o as a,d as o,_ as X,a as ve,r as v,x as me,h as B,I as C,b as fe,y as ge,w as _e,n as b,t as m,f as _,e as x,p as j,l as U,k as he,F as L,g as T,z as ye,B as be,C as xe,G as w,i as we,P as J,s as ke,j as $e,A as Ee,H as k,v as W,D as P,u as Ce,E as Z,m as N}from"./index-DcsBdKTs.js";import{S as q}from"./sweetalert2.esm.all-NNS-RXd7.js";import{C as Le}from"./CodeIcon-Z4k7ubzn.js";import{r as Te}from"./ShoppingCartIcon-sW3ScxUa.js";function Se(F,f){return a(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}const Ae={},Be={viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg",fill:"none"};function Pe(F,f){return a(),r("svg",Be,[...f[0]||(f[0]=[ve('<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path stroke="#e0bc0b" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M27 7H5a2 2 0 00-2 2v14a2 2 0 002 2h22a2 2 0 002-2V9a2 2 0 00-2-2z"></path> <path stroke="#e0bc0b" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 13l3 6.5 3-6.5M16.5 13v6.5M20.5 17.275h1.48c.651 0 1.277-.275 1.721-.75a2.338 2.338 0 00.215-2.932 1.394 1.394 0 00-1.14-.593H20.5v4.275zm0 0V19.5"></path></g>',3)])])}const Ie=X(Ae,[["render",Pe]]),Oe={class:"min-h-screen bg-gray-50"},De={class:"bg-white shadow-sm border-b border-gray-200"},Ve={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},ze={key:1,class:"sr-only"},Me={"aria-label":"Breadcrumb",class:"breadcrumbs text-primary text-sm mt-4",dir:"rtl"},Re={itemscope:"",itemtype:"https://schema.org/BreadcrumbList"},je={itemprop:"itemListElement",itemscope:"",itemtype:"https://schema.org/ListItem"},Ue=["href"],Ne={itemprop:"itemListElement",itemscope:"",itemtype:"https://schema.org/ListItem","aria-current":"page",class:"text-gray-700"},Fe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",role:"main"},He={class:"lg:flex lg:gap-8"},Ge={class:"lg:w-7/10"},Qe={class:"relative aspect-video"},Ke=["poster"],Ye={class:"hidden ms:block"},Je={class:"flex gap-2 md:gap-4 flex flex-col md:flex-row items-center"},We={key:0,class:"pb-1 px-2"},Ze=["value"],qe={class:"bg-white rounded-lg shadow-md p-6 mb-6 mt-6","aria-labelledby":"episode-title"},Xe={key:0,class:"prose xl:prose-lg 2xl:prose-xl text-justify max-w-none"},et=["innerHTML"],tt={class:"py-2"},ot=["onClick"],st={key:1,class:"flex flex-col gap-10"},it={class:"skeleton h-4 w-full"},lt={key:0,class:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg shadow-md p-6 text-white"},at={class:"text-xl mb-2"},rt={class:"mb-4 opacity-90"},nt={class:"lg:w-3/10 mb-8 lg:mb-0","aria-label":"فهرست اپیزودها"},ut={class:"bg-white rounded-lg shadow-md p-4"},dt={class:"space-y-2"},ct={class:"font-medium text-gray-900"},pt={class:"skeleton p-8 w-full"},vt={__name:"ShowEpisodeView",setup(F){const f=we(),I=$e(),H=v(!0),d=v(null),e=v(null),h=v(null),O=v([]),ee=v(null);v("");const S=v(!1),te=v({}),n=v(null),D=v([]),G=v(-1);me([]);const oe=s=>{if(!e.value)return"";let t=`${w()}site/active-user/get-course-video-file/${e.value.product_id}/${e.value.id}`,l=`${t}/${e.value.video_type}/${s}`;return C()==!1&&(t=`${w()}site/get-course-video-file/${e.value.product_id}/${e.value.id}`,l=`${t}/${e.value.video_type}/${s}`),l},V=()=>e.value?`${`${w()}site/get-file/${f.params.course_link}/episode/${f.params.episode_link}`}/${e.value.video_poster}`:"",z=v(!1),$={appUrl:"https://play.nitrocode.ir",config:{view:"split"},params:{console:"full",compiled:"none"}},se=xe(()=>Z(()=>import("./vue-D26iAzpO.js"),__vite__mapDeps([0,1,2]))),Q=async s=>{z.value=!0,s.params&&($.params={...$.params,...s.params}),s.config&&($.config={...$.config,...s.config})},ie=()=>{if(!e.value||!d.value)return;const s=document.querySelector('script[type="application/ld+json"]');s&&s.remove();const t="https://nitrocode.ir/courses/",l=e.value.meta_canonical||`${t}${d.value.link}/${e.value.link}`,i=ue?.value||null,u=V()?encodeURI(V()):void 0,c=[{property:"og:title",content:e.value.meta_title||e.value.title},{property:"og:description",content:e.value.meta_description},{property:"og:image",content:u||""},{name:"description",content:e.value.meta_description},{name:"keywords",content:e.value.meta_keywords||""}];i&&(c.push({property:"og:video",content:i}),c.push({property:"og:video:type",content:"application/dash+xml"})),c.push({name:"robots",content:e?.value?.meta_robots}),c.push({name:"twitter:card",content:"summary_large_image"}),c.push({name:"twitter:title",content:e.value.meta_title||e.value.title}),c.push({name:"twitter:description",content:e.value.meta_description||e.value.description||""}),c.push({name:"twitter:image",content:u||""});const g={"@context":"https://schema.org","@graph":[]},A={"@type":"Course",name:d.value.title,description:k(d.value.description),url:`${t}${d.value.link}`,provider:{"@type":"Organization",name:"NitroCode",url:"https://nitrocode.ir"}};g["@graph"].push(A);const E={"@type":"Organization",name:"NitroCode"};if(Y?.value===!0){const p={"@type":"VideoObject",name:e.value.title,description:k(e.value.description),thumbnailUrl:u,isAccessibleForFree:!1,requiresSubscription:!0,inLanguage:"fa",mainEntityOfPage:l,publisher:E,isPartOf:{"@type":"Course",name:d.value.title,url:`${t}${d.value.link}`,description:k(d.value.description),provider:{"@type":"Organization",name:"NitroCode",url:"https://nitrocode.ir"}}};if(i){const y={"@type":"Clip",name:`${e.value.title} — پیش‌نمایش`,description:k(e.value.description),startOffset:0,endOffset:e.value?.free_demo_time,isAccessibleForFree:!0,url:l,inLanguage:"fa",contentUrl:i};p.hasPart=y}p.duration=W(e.value?.duration),p.uploadDate=P(e.value.created_at),p.dateModified=P(e.value.updated_at),Object.keys(p).forEach(y=>p[y]===void 0&&delete p[y]),g["@graph"].push(p)}else{const p={"@type":"VideoObject",name:e.value.title,description:k(e.value.description),thumbnailUrl:u,contentUrl:i||void 0,isAccessibleForFree:!0,inLanguage:"fa",mainEntityOfPage:l,publisher:E,isPartOf:{"@type":"Course",name:d.value.title,url:`${t}${d.value.link}`,description:k(d.value.description),provider:{"@type":"Organization",name:"NitroCode",url:"https://nitrocode.ir"}}};p.duration=W(e.value?.duration),p.uploadDate=P(e.value.created_at),p.dateModified=P(e.value.updated_at),Object.keys(p).forEach(y=>p[y]===void 0&&delete p[y]),g["@graph"].push(p)}const pe={"@type":"BreadcrumbList",itemListElement:[{"@type":"ListItem",position:1,name:"صفحه اصلی",item:"https://nitrocode.ir"},{"@type":"ListItem",position:2,name:"دوره‌ها",item:t},{"@type":"ListItem",position:3,name:d.value.title||"",item:`${t}${d.value.link}`},{"@type":"ListItem",position:4,name:e.value.title||"",item:l}]};g["@graph"].push(pe),Ce({title:e.value.meta_title||e.value.title,meta:c,link:[{rel:"canonical",href:l}].concat(h.value?[{rel:"next",href:`${t}${d.value.link}/${h.value.link}`}]:[]),script:[{type:"application/ld+json",children:JSON.stringify(g)}]})},K=async()=>{z.value=!1;try{H.value=!0;const{course_link:s,episode_link:t}=f.params;let l=null;C()?l=await J(`site/active-user/course/${s}/episode/${t}`):l=await J(`site/course/${s}/episode/${t}`),l.ok&&(d.value=l.product,e.value=l.episode,h.value=l.next_episode,O.value=l.episode_list,te.value=l.author||{},ke(()=>{ie(),le(),setTimeout(()=>{window.isLoading.value=!1},100),e.value.extentions=JSON.parse(e.value.extentions);for(const i of e.value.extentions)console.log(i),console.log(i.type,i?.show_status),i?.type==="livecodes"&&i?.show_status==="force_show"&&Q(i)}))}catch(s){console.error("Error fetching episode data:",s)}finally{H.value=!1}},le=async()=>{try{const{MediaPlayer:s}=await Z(async()=>{const{MediaPlayer:c}=await import("./dash.all.min-D3TBEzDq.js");return{MediaPlayer:c}},[]);n.value&&(n.value.destroy(),n.value=null);let t=e.value.video_target,l=`${w()}site/active-user/get-course-video-file/${e.value.product_id}/${e.value.id}`,i=`${l}/${e.value.video_type}/${t}`;C()==!1&&(l=`${w()}site/get-course-video-file/${e.value.product_id}/${e.value.id}`,i=`${l}/${e.value.video_type}/${t}`),(M.value||R.value)&&(t=e.value.video_preview_target||"preview.mpd",l=`${w()}site/get-course-video-file/${e.value.product_id}/${e.value.id}`,i=`${l}/${e.value.video_type}/${t}`),n.value=s().create(),n.value.updateSettings({streaming:{abr:{autoSwitchBitrate:{audio:!0,video:!0}}}}),n.value.initialize(document.querySelector("#videoPlayer"),i,!1),n.value.on(s.events.QUALITY_CHANGE_REQUESTED,c=>{}),n.value.on(s.events.PLAYBACK_METADATA_LOADED,c=>{D.value=ae(n.value)}),n.value.on(s.events.QUALITY_CHANGE_RENDERED,c=>{});let u=!1;n.value.on(s.events.PLAYBACK_TIME_UPDATED,c=>{const g=document.querySelector("#videoPlayer");if(g&&!u){const A=g.currentTime,E=g.duration;E-A<=5&&E>0&&A>0&&(u=!0,S.value=!0)}}),n.value.on(s.events.PLAYBACK_STARTED,c=>{u=!1}),n.value.on(s.events.PLAYBACK_ENDED,c=>{u=!1,S.value=!0})}catch(s){console.error(s)}},ae=s=>{if(!s)return[];try{return(s.getRepresentationsByType("video")||[]).map((l,i)=>({index:i,bitrate:l.bitrate,bitrateInKbit:l.bitrateInKbit,width:l.width,height:l.height,id:l.id,label:`${l.height}p`}))}catch(t){return console.error("خطا در دریافت لیست کیفیت‌ها:",t),[]}},re=s=>{if(!n.value)return;const t=s.target.value;t===""?(n.value.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!0}}}}),G.value=-1):(n.value.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!1}}}}),ne(n.value,t)&&(G.value=t))},ne=(s,t)=>{if(!s)return!1;try{const l=s.getRepresentationsByType("video")||[],i=l.find(u=>u.id==t);return i?(s.setRepresentationForTypeById("video",i.id,!0),!0):(console.warn("Representation موردنظر پیدا نشد:",t,l),!1)}catch(l){return console.error("خطا در تغییر کیفیت:",l),!1}},M=B(()=>e.value?["free_with_login","vip_preview","vip"].indexOf(e.value.display_status)>-1&&C()==!1:!1),R=B(()=>e.value?!!((e.value.display_status=="vip_preview"||e.value.display_status=="vip")&&C()&&e?.value?.user_has_access==!1):!1),Y=B(()=>M.value||R.value),ue=B(()=>{if(!e.value)return"";let s=e.value.video_target;return Y.value&&(s=e.value.video_preview_target||"preview.mpd"),oe(s)});K(),fe(()=>{window.scrollTo(0,0)}),ge(()=>{n.value&&(n.value.destroy(),n.value=null)}),_e(()=>f.params.episode_link,(s,t)=>{s&&s!==t&&(K(),window.scrollTo(0,0))});const de=()=>{window.localStorage.setItem("redirect_after_login",f.fullPath),I.push({name:"login"})},ce=async()=>{try{const s=await Ee("site/active-user/course-shopping/add-to-cart/"+d.value.id);(s.ok||s.ok==!1&&s.carts&&s.carts.length)&&q.fire({icon:"success",title:"دوره به سبد خرید اضافه شد",text:"می‌توانید پرداخت را انجام دهید یا سبد خرید را مشاهده کنید.",showCancelButton:!0,confirmButtonText:"پرداخت و مشاهده‌ی دوره",cancelButtonText:"مشاهده سبد خرید"}).then(t=>{t.isConfirmed?I.push({name:"user_cart",hash:"#checkout_now"}):t.dismiss===q.DismissReason.cancel&&I.push({name:"user_cart"})})}catch(s){console.error(s)}};return(s,t)=>{const l=he("router-link");return a(),r("div",Oe,[o("header",De,[o("div",Ve,[e.value?(a(),r("h1",{key:0,class:b(["text-xl md:text-2xl font-bold text-gray-900",{"skeleton w-56 p-4":!e.value?.title}])},m(e.value?.title||""),3)):(a(),r("h1",ze,"در حال بارگذاری اپیزود...")),o("nav",Me,[o("ul",Re,[t[4]||(t[4]=o("li",{itemprop:"itemListElement",itemscope:"",itemtype:"https://schema.org/ListItem"},[o("a",{itemprop:"item",href:"/"},[o("span",{itemprop:"name"},"صفحه اصلی")]),o("meta",{itemprop:"position",content:"1"})],-1)),t[5]||(t[5]=o("li",{itemprop:"itemListElement",itemscope:"",itemtype:"https://schema.org/ListItem"},[o("a",{itemprop:"item",href:"/courses"},[o("span",{itemprop:"name"},"دوره‌ها")]),o("meta",{itemprop:"position",content:"2"})],-1)),o("li",je,[o("a",{itemprop:"item",href:`/courses/${d.value?.link||""}`},[o("span",{itemprop:"name",class:b({"skeleton w-56 p-3":!e.value?.title})},m(d.value?.title||""),3)],8,Ue),t[2]||(t[2]=o("meta",{itemprop:"position",content:"3"},null,-1))]),o("li",Ne,[o("span",{itemprop:"name",class:b({"skeleton w-56 p-3":!e.value?.title})},m(e.value?.title||""),3),t[3]||(t[3]=o("meta",{itemprop:"position",content:"4"},null,-1))])])])])]),o("div",Fe,[o("div",He,[o("div",Ge,[o("article",{class:b(["rounded-lg shadow-md overflow-hidden shadow-lg",{skeleton:!e.value?.title}]),"aria-labelledby":"episode-title"},[o("div",Qe,[e.value?(a(),r("video",{key:0,id:"videoPlayer",ref_key:"videoPlayer",ref:ee,class:"w-full h-full",controls:"",poster:V(),preload:"metadata",playsinline:""}," مرورگر شما از پخش ویدیو پشتیبانی نمی‌کند لطفا از آخرین نسخه از مرورگر گوگل کروم استفاده کنید ",8,Ke)):_("",!0),M.value?(a(),r("div",{key:1,class:b(["pulse-opacity-smooth top-0 left-0 w-full gap-2 flex justify-center lg:justify-between p-4 absolute z-10 items-center duration-500 h-20",{"h-full":S.value}])},[t[7]||(t[7]=o("div",{class:"flex-1"},[o("div",{class:"text-sm sm:text-md md:text-lg lg:text-xl font-bold p-2 text-teal-300"}," برای مشاهده‌ی کامل این ویدیو لطفا وارد سایت (حساب کاربری) شوید "),o("p")],-1)),o("div",null,[o("button",{onClick:t[0]||(t[0]=i=>de()),class:"btn btn-sm md:btn-md btn-primary"},[t[6]||(t[6]=o("div",null,"ورود و مشاهده",-1)),o("div",null,[x(j(Se),{class:"size-5 animate-pulse text-green-300"})])])])],2)):_("",!0),R.value?(a(),r("div",{key:2,class:b(["pulse-opacity-smooth top-0 left-0 w-full gap-1 md:gap-2 lg:gap-8 flex flex-col justify-center p-2 ms:p-4 absolute z-10 items-center duration-500",{"h-full":S.value}])},[o("div",Ye,[x(Ie,{class:"size-8 md:size-12 fill-yello-700 text-yellow-700"})]),t[10]||(t[10]=o("div",{class:"text-md sm:text-lg md:text-xl lg:text-2xl font-bold text-center p-2 text-white"}," بعد از خرید این دوره تمام قسمت‌های آن قابل مشاهده است ",-1)),o("div",Je,[o("button",{onClick:t[1]||(t[1]=i=>ce()),class:"text-sm md:text-md lg:text-lg hover:bg-black duration-200 cursor-pointer flex items-center gap-2 p-2 border-2 border-[#e0bc0b] text-[#e0bc0b] font-bold rounded-lg items-center"},[t[8]||(t[8]=o("div",null,"خرید این دوره و مشاهده",-1)),o("div",null,[x(j(Te),{class:"size-6 animate-pulse text-green-[#e0bc0b]"})])]),x(l,{to:"/courses/"+d.value?.link,class:"text-sm md:text-md lg:text-lg opacity-80 hover:bg-black duration-200 cursor-pointer flex items-center gap-2 p-2 border-2 border-gray-300 text-gray-300 font-bold rounded-lg items-center"},{default:U(()=>[...t[9]||(t[9]=[N(" مشاهده‌ي اطلاعات دوره ",-1)])]),_:1},8,["to"])])],2)):_("",!0)]),D.value.length>1?(a(),r("div",We,[o("select",{class:"select select-ghost select-sm",onChange:re},[t[11]||(t[11]=o("option",{value:""},"انتخاب کیفیت : اتوماتیک",-1)),(a(!0),r(L,null,T(D.value,(i,u)=>(a(),r("option",{key:u,value:i.id},m(i.label)+" "+m(i.label=="1080p"?" (کیفیت عالی)":"")+" "+m(i.label=="720p"?" (کیفیت خوب)":"")+" "+m(i.label=="480p"?" (کیفیت کم)":""),9,Ze))),128))],32)])):_("",!0)],2),o("section",qe,[t[13]||(t[13]=o("h2",{id:"episode-title",class:"sr-only"},"اطلاعات اپیزود",-1)),e.value?.description?(a(),r("div",Xe,[e.value?.description?(a(),r("p",{key:0,class:"text-gray-800",innerHTML:e.value?.description},null,8,et)):_("",!0),(a(!0),r(L,null,T(e.value.extentions,(i,u)=>(a(),r("div",tt,[i.show_status==="button"&&i.type==="livecodes"?(a(),r("button",{key:0,onClick:c=>Q(i),class:"btn btn-primary"},[t[12]||(t[12]=N(" ویرایشگر کد آنلاین ",-1)),x(Le,{class:"size-6 animate-pulse"})],8,ot)):_("",!0)]))),256)),z.value?(a(),ye(j(se),be({key:e.value.id,dir:"ltr"},$),null,16)):_("",!0)])):(a(),r("div",st,[(a(!0),r(L,null,T(Array.from({length:10},(i,u)=>u),i=>(a(),r("div",it))),256))]))]),h.value?(a(),r("div",lt,[t[15]||(t[15]=o("h3",{class:"text-lg font-bold mb-2"},"قسمت بعدی",-1)),o("h4",at,m(h.value.title),1),o("p",rt,m(h.value.small_description),1),x(l,{to:{name:"show_episode",params:{course_link:s.course_link,episode_link:h.value.link}},class:"block bg-white text-blue-600 font-semibold px-4 py-2 rounded-lg hover:bg-gray-100 transition-colors flex items-center"},{default:U(()=>[...t[14]||(t[14]=[N(" مشاهده قسمت بعدی ",-1),o("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 5l7 7m0 0l-7 7m7-7H3"})],-1)])]),_:1},8,["to"])])):_("",!0)]),o("aside",nt,[o("div",ut,[t[16]||(t[16]=o("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"لیست اپیزودها",-1)),o("ul",dt,[O.value.length?(a(!0),r(L,{key:0},T(O.value,(i,u)=>(a(),r("li",{key:u,class:b(["",i.link===e.value?.link?"bg-blue-50 border-r-4 border-blue-500":"hover:bg-gray-50"])},[x(l,{to:{name:"show_episode",params:{course_link:s.course_link,episode_link:i.link}},class:"p-3 rounded-lg cursor-pointer transition-colors block"},{default:U(()=>[o("h3",ct,m(i.title),1)]),_:2},1032,["to"])],2))),128)):(a(!0),r(L,{key:1},T(Array.from({length:10},(i,u)=>u+1),i=>(a(),r("li",pt))),256))])])])])])])}}},ht=X(vt,[["__scopeId","data-v-2e99adfd"]]);export{ht as default};
