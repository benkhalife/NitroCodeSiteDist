import{r as v,b,c as r,o as n,d as t,e as y,l as k,k as C,F as j,g as B,t as c,A as f,i as E,j as F,m as M,p as L,G as R}from"./index-BrrRsSYd.js";import{S as i}from"./sweetalert2.esm.all-NNS-RXd7.js";const N={class:"bg-base-200 min-h-dvh"},P={class:"container mx-auto p-4 max-w-6xl"},S={key:0,class:"flex justify-center items-center h-64"},T={key:1,class:"card bg-base-100 shadow-xl"},V={class:"card-body text-center py-16"},z={key:2,class:"grid lg:grid-cols-3 gap-6"},A={class:"lg:col-span-2"},D={class:"space-y-4"},G={class:"card-body p-4"},H={class:"flex flex-col sm:flex-row gap-4"},I={class:"avatar"},$={class:"w-24 h-24 rounded-lg overflow-hidden"},U=["src","alt"],q={class:"flex-grow"},J={class:"card-title text-lg"},K={class:"mt-2"},O={class:"text-2xl font-bold text-primary"},Q={class:"flex flex-col justify-center"},W=["onClick"],X={class:"lg:col-span-1"},Y={class:"card bg-base-100 shadow-md sticky top-4"},Z={class:"card-body"},tt={class:"space-y-2"},st={class:"flex justify-between"},et={class:"flex justify-between font-bold text-lg"},ot={class:"card-actions justify-end mt-6"},rt=["disabled"],nt={key:0},lt={key:1,class:"loading loading-spinner loading-sm"},ut={__name:"Cart",setup(it){const l=v([]),d=v(!0),a=v(!1),h=E(),w=F(),_=async()=>{try{d.value=!0;const e=await f("site/active-user/course-shopping/cart-list");if(e.ok)l.value=e.list,h.hash==="#checkout_now"&&l.value.length>0&&(await w.replace({name:"user_cart",hash:""}),window.isLoading.value=!0,m());else throw new Error("Failed to fetch cart items")}catch(e){console.error("Error fetching cart:",e),i.fire({icon:"error",title:"Error",text:"مشکلی روی داده است لطفا بعدا تلاش کنید و یا با پشتیبانی تماس بگیرید"})}finally{d.value=!1}},x=async e=>{try{if((await i.fire({title:"حذف از سبد خرید",text:"می‌خواهید دوره را از سبد خرید حذف کنید؟",icon:"warning",showCancelButton:!0,cancelButtonText:"لغو",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"بله حذف کن"})).isConfirmed)if((await f(`site/active-user/course-shopping/remove-from-cart/${e}`)).ok)l.value=l.value.filter(o=>o.id!==e),i.fire("حذف شد","همون طور که خواستی دوره از سبد خرید حذف شد","success");else throw new Error("Failed to remove item")}catch(s){console.error("Error removing item:",s),i.fire({icon:"error",title:"Error",text:"مشکلی روی داده است لطفا بعدا تلاش کنید و یا با پشتیبانی تماس بگیرید"})}},m=async()=>{try{a.value=!0;const e=await f("site/active-user/course-shopping/get-gateway-link");if(e.ok&&e.link)window.location.href=e.link;else throw new Error(e?.error||"Failed to get payment link")}catch(e){console.error("Error getting payment link:",e),i.fire({icon:"error",title:"Error",text:e||"مشکلی روی داده است لطفا بعدا تلاش کنید و یا با پشتیبانی تماس بگیرید"})}finally{a.value=!1}},p=()=>l.value.reduce((e,s)=>e+s.price,0),u=e=>new Intl.NumberFormat("fa-IR",{style:"currency",currency:"IRR",minimumFractionDigits:0}).format(e);return b(()=>{_()}),(e,s)=>{const g=C("router-link");return n(),r("div",N,[t("div",P,[s[11]||(s[11]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-center mb-2"},"سبد خرید"),t("div",{class:"divider"})],-1)),d.value?(n(),r("div",S,[...s[0]||(s[0]=[t("span",{class:"loading loading-spinner loading-lg"},null,-1)])])):l.value.length===0?(n(),r("div",T,[t("div",V,[s[2]||(s[2]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-24 w-24 mx-auto mb-4 text-base-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),s[3]||(s[3]=t("h2",{class:"text-2xl font-semibold mb-2"},"سبد خرید شما خالی است",-1)),s[4]||(s[4]=t("p",{class:"text-base-content/70 mb-6"},"با کلیک روی دکمه زیر می‌توانی دوره‌ها را مشاهده و به سبد خرید خود اضافه کنید",-1)),y(g,{to:"/courses",class:"btn btn-primary"},{default:k(()=>[...s[1]||(s[1]=[M("مشاهده‌ی دوره های نیتروکد",-1)])]),_:1})])])):(n(),r("div",z,[t("div",A,[t("div",D,[(n(!0),r(j,null,B(l.value,o=>(n(),r("div",{key:o.id,class:"card bg-base-100 shadow-md"},[t("div",G,[t("div",H,[t("div",I,[t("div",$,[t("img",{src:L(R)()+o.image,alt:o.title,class:"object-cover w-full h-full"},null,8,U)])]),t("div",q,[t("h3",J,c(o.title),1),t("div",K,[t("span",O,c(u(o.price)),1)])]),t("div",Q,[t("button",{onClick:at=>x(o.id),class:"btn btn-sm btn-circle btn-outline btn-error"},[...s[5]||(s[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,W)])])])]))),128))])]),t("div",X,[t("div",Y,[t("div",Z,[s[10]||(s[10]=t("h2",{class:"card-title text-xl mb-4"},"خلاصه سفارش",-1)),t("div",tt,[t("div",st,[s[6]||(s[6]=t("span",null,"قابل پرداخت",-1)),t("span",null,c(u(p())),1)]),s[8]||(s[8]=t("div",{class:"flex justify-between"},[t("span",null,"مالیات"),t("span",null,"به مبلغ نهایی ۱۰ درصد مالیات بر ارزش افزوده اضافه می‌گردد")],-1)),s[9]||(s[9]=t("div",{class:"divider my-2"},null,-1)),t("div",et,[s[7]||(s[7]=t("span",null,"مجموع",-1)),t("span",null,c(u(p())),1)])]),t("div",ot,[t("button",{onClick:m,class:"btn btn-primary w-full",disabled:a.value},[a.value?(n(),r("span",lt)):(n(),r("span",nt,"Proceed to Checkout"))],8,rt)])])])])]))])])}}};export{ut as default};
