import{r as T,b as Y,w as Z,y as ee,O as te}from"./index-D6bc6A0Y.js";var re=Object.create,K=Object.defineProperty,oe=Object.getOwnPropertyDescriptor,ne=Object.getOwnPropertyNames,se=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty,ie=(u,m)=>()=>(m||u((m={exports:{}}).exports,m),m.exports),le=(u,m,P,d)=>{if(m&&typeof m=="object"||typeof m=="function")for(let S of ne(m))!ae.call(u,S)&&S!==P&&K(u,S,{get:()=>m[S],enumerable:!(d=oe(m,S))||d.enumerable});return u},ce=(u,m,P)=>(P=u!=null?re(se(u)):{},le(!u||!u.__esModule?K(P,"default",{value:u,enumerable:!0}):P,u)),de=ie((u,m)=>{var P=(function(){var d=String.fromCharCode,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",C={};function c(e,r){if(!C[e]){C[e]={};for(var s=0;s<e.length;s++)C[e][e.charAt(s)]=s}return C[e][r]}var x={compressToBase64:function(e){if(e==null)return"";var r=x._compress(e,6,function(s){return S.charAt(s)});switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(e){return e==null?"":e==""?null:x._decompress(e.length,32,function(r){return c(S,e.charAt(r))})},compressToUTF16:function(e){return e==null?"":x._compress(e,15,function(r){return d(r+32)})+" "},decompressFromUTF16:function(e){return e==null?"":e==""?null:x._decompress(e.length,16384,function(r){return e.charCodeAt(r)-32})},compressToUint8Array:function(e){for(var r=x.compress(e),s=new Uint8Array(r.length*2),o=0,n=r.length;o<n;o++){var w=r.charCodeAt(o);s[o*2]=w>>>8,s[o*2+1]=w%256}return s},decompressFromUint8Array:function(e){if(e==null)return x.decompress(e);for(var r=new Array(e.length/2),s=0,o=r.length;s<o;s++)r[s]=e[s*2]*256+e[s*2+1];var n=[];return r.forEach(function(w){n.push(d(w))}),x.decompress(n.join(""))},compressToEncodedURIComponent:function(e){return e==null?"":x._compress(e,6,function(r){return N.charAt(r)})},decompressFromEncodedURIComponent:function(e){return e==null?"":e==""?null:(e=e.replace(/ /g,"+"),x._decompress(e.length,32,function(r){return c(N,e.charAt(r))}))},compress:function(e){return x._compress(e,16,function(r){return d(r)})},_compress:function(e,r,s){if(e==null)return"";var o,n,w={},b={},O="",E="",g="",h=2,p=3,f=2,v=[],t=0,l=0,i;for(i=0;i<e.length;i+=1)if(O=e.charAt(i),Object.prototype.hasOwnProperty.call(w,O)||(w[O]=p++,b[O]=!0),E=g+O,Object.prototype.hasOwnProperty.call(w,E))g=E;else{if(Object.prototype.hasOwnProperty.call(b,g)){if(g.charCodeAt(0)<256){for(o=0;o<f;o++)t=t<<1,l==r-1?(l=0,v.push(s(t)),t=0):l++;for(n=g.charCodeAt(0),o=0;o<8;o++)t=t<<1|n&1,l==r-1?(l=0,v.push(s(t)),t=0):l++,n=n>>1}else{for(n=1,o=0;o<f;o++)t=t<<1|n,l==r-1?(l=0,v.push(s(t)),t=0):l++,n=0;for(n=g.charCodeAt(0),o=0;o<16;o++)t=t<<1|n&1,l==r-1?(l=0,v.push(s(t)),t=0):l++,n=n>>1}h--,h==0&&(h=Math.pow(2,f),f++),delete b[g]}else for(n=w[g],o=0;o<f;o++)t=t<<1|n&1,l==r-1?(l=0,v.push(s(t)),t=0):l++,n=n>>1;h--,h==0&&(h=Math.pow(2,f),f++),w[E]=p++,g=String(O)}if(g!==""){if(Object.prototype.hasOwnProperty.call(b,g)){if(g.charCodeAt(0)<256){for(o=0;o<f;o++)t=t<<1,l==r-1?(l=0,v.push(s(t)),t=0):l++;for(n=g.charCodeAt(0),o=0;o<8;o++)t=t<<1|n&1,l==r-1?(l=0,v.push(s(t)),t=0):l++,n=n>>1}else{for(n=1,o=0;o<f;o++)t=t<<1|n,l==r-1?(l=0,v.push(s(t)),t=0):l++,n=0;for(n=g.charCodeAt(0),o=0;o<16;o++)t=t<<1|n&1,l==r-1?(l=0,v.push(s(t)),t=0):l++,n=n>>1}h--,h==0&&(h=Math.pow(2,f),f++),delete b[g]}else for(n=w[g],o=0;o<f;o++)t=t<<1|n&1,l==r-1?(l=0,v.push(s(t)),t=0):l++,n=n>>1;h--,h==0&&(h=Math.pow(2,f),f++)}for(n=2,o=0;o<f;o++)t=t<<1|n&1,l==r-1?(l=0,v.push(s(t)),t=0):l++,n=n>>1;for(;;)if(t=t<<1,l==r-1){v.push(s(t));break}else l++;return v.join("")},decompress:function(e){return e==null?"":e==""?null:x._decompress(e.length,32768,function(r){return e.charCodeAt(r)})},_decompress:function(e,r,s){var o=[],n=4,w=4,b=3,O="",E=[],g,h,p,f,v,t,l,i={val:s(0),position:r,index:1};for(g=0;g<3;g+=1)o[g]=g;for(p=0,v=Math.pow(2,2),t=1;t!=v;)f=i.val&i.position,i.position>>=1,i.position==0&&(i.position=r,i.val=s(i.index++)),p|=(f>0?1:0)*t,t<<=1;switch(p){case 0:for(p=0,v=Math.pow(2,8),t=1;t!=v;)f=i.val&i.position,i.position>>=1,i.position==0&&(i.position=r,i.val=s(i.index++)),p|=(f>0?1:0)*t,t<<=1;l=d(p);break;case 1:for(p=0,v=Math.pow(2,16),t=1;t!=v;)f=i.val&i.position,i.position>>=1,i.position==0&&(i.position=r,i.val=s(i.index++)),p|=(f>0?1:0)*t,t<<=1;l=d(p);break;case 2:return""}for(o[3]=l,h=l,E.push(l);;){if(i.index>e)return"";for(p=0,v=Math.pow(2,b),t=1;t!=v;)f=i.val&i.position,i.position>>=1,i.position==0&&(i.position=r,i.val=s(i.index++)),p|=(f>0?1:0)*t,t<<=1;switch(l=p){case 0:for(p=0,v=Math.pow(2,8),t=1;t!=v;)f=i.val&i.position,i.position>>=1,i.position==0&&(i.position=r,i.val=s(i.index++)),p|=(f>0?1:0)*t,t<<=1;o[w++]=d(p),l=w-1,n--;break;case 1:for(p=0,v=Math.pow(2,16),t=1;t!=v;)f=i.val&i.position,i.position>>=1,i.position==0&&(i.position=r,i.val=s(i.index++)),p|=(f>0?1:0)*t,t<<=1;o[w++]=d(p),l=w-1,n--;break;case 2:return E.join("")}if(n==0&&(n=Math.pow(2,b),b++),o[l])O=o[l];else if(l===w)O=h+h.charAt(0);else return null;E.push(O),o[w++]=h+O.charAt(0),n--,h=O,n==0&&(n=Math.pow(2,b),b++)}}};return x})();typeof m<"u"&&m!=null&&(m.exports=P)}),D=ce(de());async function G(u,m={}){typeof u=="object"&&!(u instanceof HTMLElement)&&(u.headless||u.view==="headless")&&(m=u,u=null);let{config:P={},headless:d,loading:S="lazy",view:N}=m,C=d||N==="headless",c=null,x=null;if(typeof u=="string")c=document.querySelector(u);else if(u instanceof HTMLElement)c=u;else if(!(C&&typeof u=="object"))throw new Error("A valid container element is required.");if(!c)if(C)c=document.createElement("div"),q(c),document.body.appendChild(c);else throw new Error(`Cannot find element: "${u}"`);let e=new URL(ue(m)),r=e.origin;e.searchParams.set("embed","true"),e.searchParams.set("loading",C?"eager":S),e.searchParams.set("sdkVersion","0.12.0"),typeof P=="object"&&Object.keys(P).length>0&&e.searchParams.set("config","sdk");let s=m.params;typeof s=="object"&&Object.keys(s).length>0&&JSON.stringify(s).length<1800&&Object.keys(s).forEach(a=>{e.searchParams.set(a,encodeURIComponent(String(s[a])))});let o=!1,n="Cannot call API methods after calling `destroy()`.",w=[],b=(a,y="message")=>{addEventListener(y,a),w.push(a)},O=await new Promise(a=>{var y,A,U,k,M,J,R,L,F;if(!c)return;let I=c.dataset.height||c.style.height;if(I&&!C){let W=isNaN(Number(I))?I:I+"px";c.style.height=W}c.dataset.defaultStyles!=="false"&&!C&&((y=c.style).backgroundColor||(y.backgroundColor="#fff"),(A=c.style).border||(A.border="1px solid black"),(U=c.style).borderRadius||(U.borderRadius="8px"),(k=c.style).boxSizing||(k.boxSizing="border-box"),(M=c.style).padding||(M.padding="0"),(J=c.style).width||(J.width="100%"),(R=c.style).height||(R.height=c.style.height||"300px"),c.style.minHeight="200px",c.style.flexGrow="1",(L=c.style).overflow||(L.overflow="hidden"),(F=c.style).resize||(F.resize="vertical"));let B="livecodes",V=c.querySelector(`iframe.${B}`),j=V||document.createElement("iframe");j.classList.add(B),j.setAttribute("allow","accelerometer; camera; encrypted-media; display-capture; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; web-share"),j.setAttribute("allowtransparency","true"),j.setAttribute("allowpaymentrequest","true"),j.setAttribute("allowfullscreen","true"),j.setAttribute("sandbox","allow-same-origin allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-presentation allow-scripts");let X=S==="eager"?"eager":"lazy";j.setAttribute("loading",X),C?q(j):(j.style.height="100%",j.style.minHeight="200px",j.style.width="100%",j.style.margin="0",j.style.border="0",j.style.borderRadius=c.style.borderRadius),b(function W(_){var z;_.source!==j.contentWindow||_.origin!==r||((z=_.data)==null?void 0:z.type)!=="livecodes-init"||(removeEventListener("message",W),x=Number(_.data.payload.appVersion.replace(/^v/,"")))}),(!x||x<46)&&b(function W(_){var z,$;_.source!==j.contentWindow||_.origin!==r||((z=_.data)==null?void 0:z.type)!=="livecodes-get-config"||(removeEventListener("message",W),($=j.contentWindow)==null||$.postMessage({type:"livecodes-config",payload:P},r))}),j.onload=()=>{a(j)},j.src=e.href,V||c.appendChild(j)}),E=new Promise(a=>{b(function y(A){var U;A.source!==O.contentWindow||A.origin!==r||((U=A.data)==null?void 0:U.type)!=="livecodes-ready"||(removeEventListener("message",y),a(),E.settled=!0)})}),g=()=>o?Promise.reject(n):new Promise(async a=>{var y;E.settled&&a();let A={type:"livecodes-load"};(y=O.contentWindow)==null||y.postMessage(A,r),await E,a()}),h=(a,y)=>new Promise(async(A,U)=>{var k;if(o)return U(n);await g();let M=Q();b(function J(R){var L,F;if(!(R.source!==O.contentWindow||R.origin!==r||((L=R.data)==null?void 0:L.type)!=="livecodes-api-response"||((F=R.data)==null?void 0:F.id)!==M)&&R.data.method===a){removeEventListener("message",J);let I=R.data.payload;I!=null&&I.error?U(I.error):A(I)}}),(k=O.contentWindow)==null||k.postMessage({method:a,id:M,args:y},r)}),p={},f=["load","ready","code","console","tests","destroy"],v=(a,y)=>{var A;if(o)throw new Error(n);return f.includes(a)?(h("watch",[a]),p[a]||(p[a]=[]),(A=p[a])==null||A.push(y),{remove:()=>{var U,k;p[a]=(U=p[a])==null?void 0:U.filter(M=>M!==y),((k=p[a])==null?void 0:k.length)===0&&h("watch",[a,"unsubscribe"])}}):{remove:()=>{}}},t=a=>({"livecodes-app-loaded":"load","livecodes-ready":"ready","livecodes-change":"code","livecodes-console":"console","livecodes-test-results":"tests","livecodes-destroy":"destroy"})[a];b(async function(a){var y,A,U,k;let M=t((A=(y=a.data)==null?void 0:y.type)!=null?A:"");if(a.source!==O.contentWindow||a.origin!==r||!M||!p[M])return;let J=(U=a.data)==null?void 0:U.payload;(k=p[M])==null||k.forEach(R=>{R(J)})});let l=()=>{var a;(a=O?.remove)==null||a.call(O),Object.values(p).forEach(y=>{y.length=0}),w.forEach(y=>removeEventListener("message",y)),w.length=0,i&&c&&i.unobserve(c),o=!0},i;S==="lazy"&&"IntersectionObserver"in window&&(i=new IntersectionObserver((a,y)=>{a.forEach(async A=>{A.isIntersecting&&(await g(),y.unobserve(c))})},{rootMargin:"150px"}),i.observe(c));function q(a){a.style.position="absolute",a.style.top="0",a.style.visibility="hidden",a.style.opacity="0"}let Q=()=>(String(Math.random())+Date.now().toFixed()).replace("0.","");return{load:()=>g(),run:()=>h("run"),format:a=>h("format",[a]),getShareUrl:a=>h("getShareUrl",[a]),getConfig:a=>h("getConfig",[a]),setConfig:a=>h("setConfig",[a]),getCode:()=>h("getCode"),show:(a,y)=>h("show",[a,y]),runTests:()=>h("runTests"),onChange:a=>v("code",a),watch:v,exec:(a,...y)=>h("exec",[a,...y]),destroy:()=>o?Promise.reject(n):(l(),Promise.resolve())}}function ue(u={}){let{appUrl:m="https://play.nitrocode.ir",params:P={},config:d={},headless:S,import:N,lite:C,view:c,...x}=u,e;try{e=new URL(m)}catch{throw new Error(`${m} is not a valid URL.`)}let r=new URLSearchParams;Object.entries(x).forEach(([o,n])=>{n!==void 0&&e.searchParams.set(o,String(n))});let s=u.view==="headless"||S;if(C&&(console.warn(`Deprecation notice: "lite" option is deprecated. Use "config: { mode: 'lite' }" instead.`),typeof d=="object"&&d.mode==null?d.mode="lite":e.searchParams.set("lite","true")),c&&(console.warn('Deprecation notice: The "view" option has been moved to "config.view". For headless mode use "headless: true".'),typeof d=="object"&&d.view==null&&c!=="headless"?d.view=c:e.searchParams.set("view",c)),typeof d=="string")try{new URL(d),e.searchParams.set("config",encodeURIComponent(d))}catch{throw new Error('"config" is not a valid URL or configuration object.')}else d&&typeof d=="object"&&Object.keys(d).length>0&&(d.title&&d.title!=="Untitled Project"&&e.searchParams.set("title",d.title),d.description&&d.description.length>0&&e.searchParams.set("description",d.description),r.set("config","code/"+(0,D.compressToEncodedURIComponent)(JSON.stringify(d))));if(P&&typeof P=="object"&&Object.keys(P).length>0)try{r.set("params",(0,D.compressToEncodedURIComponent)(JSON.stringify(P)))}catch{Object.keys(P).forEach(n=>{e.searchParams.set(n,encodeURIComponent(String(P[n])))})}return N&&e.searchParams.set("x",encodeURIComponent(N)),s&&e.searchParams.set("headless","true"),r.toString().length>0&&(e.hash=r.toString()),e.href}var pe={appUrl:String,config:[Object,String],headless:Boolean,import:String,lite:Boolean,loading:String,params:Object,template:String,view:String,height:String},H=u=>JSON.parse(JSON.stringify(u)),he={props:pe,emits:["sdkReady"],setup(u,m){let{height:P,...d}=u,S=T(),N=T(P||""),C=T(),{config:c,...x}=d,e=JSON.stringify(c),r=JSON.stringify(x);return Y(()=>{S.value&&G(S.value,H(d)).then(s=>{C.value=s,m.emit("sdkReady",s)})}),Z(u,async s=>{var o;if(!S.value||!C.value)return;let{height:n,...w}=s;N.value=n||"";let{config:b,...O}=w;typeof b=="string"&&(b=await fetch(b).then(E=>E.json())),JSON.stringify(O)!==r?(await((o=C.value)==null?void 0:o.destroy()),G(S.value,H(w)).then(E=>{C.value=E,m.emit("sdkReady",E)})):JSON.stringify(b)!==e&&C.value.setConfig(H(b)||{}),e=JSON.stringify(b),r=JSON.stringify(O)}),ee(()=>{var s;(s=C.value)==null||s.destroy()}),()=>{var s,o;return te("div",{ref:S,"data-height":N.value},((o=(s=m.slots).default)==null?void 0:o.call(s))||"")}}},ve=he;export{ve as default};
