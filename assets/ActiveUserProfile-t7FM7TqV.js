import{_ as j,r as c,v as w,L as B,b as F,c as i,o as n,d as e,f as v,t as l,m as L,H as k,J as I,n as P,M as V,A as C}from"./index-DasttT1B.js";import{S as z}from"./sweetalert2.esm.all-IjpX9IMJ.js";const H={class:"min-h-screen bg-base-200"},N={class:"hero bg-gradient-to-r from-primary to-secondary text-primary-content"},R={class:"hero-content flex-col lg:flex-row-reverse gap-8 p-8"},S={class:"avatar"},q={class:"w-48 rounded-full ring ring-offset-base-100 ring-offset-4 ring-white shadow-2xl relative group"},T=["src"],G={class:"text-center lg:text-right"},J={class:"text-4xl font-bold"},K={class:"text-lg mt-2"},O={class:"badge badge-outline badge-lg mt-2"},Q={class:"container mx-auto p-4 max-w-4xl -mt-10"},W={class:"card bg-base-100 shadow-xl"},X={class:"card-body"},Y={class:"flex justify-between items-center mb-6"},Z={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},$={class:"stat"},ee={class:"stat-value text-lg"},te={key:0,class:"stat"},se={class:"stat-value text-lg"},ae={key:1,class:"stat"},oe={class:"stat-value text-lg"},le={class:"stat"},ie={class:"stat-value text-lg"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},re={class:"form-control"},ce={class:"form-control"},de={class:"card-actions justify-end mt-6"},ue={key:0,class:"toast toast-top toast-end"},me={__name:"ActiveUserProfile",setup(ve){const a=c({}),o=w({first_name:"",last_name:""}),f=c(B()),m=c(null),d=c(!1),p=c(!1),b=c(null);(async()=>{f.value=await V(),console.log(f.value)})();const _=w({show:!1,message:"",type:"success"}),y=async()=>{try{const s=await C("site/active-user/get-profile");s.ok?(a.value=s.profile,a.value.first_name.length==0&&x()):r("خطا در دریافت اطلاعات پروفایل","error")}catch(s){r("خطا در ارتباط با سرور","error"),console.error("Error fetching profile:",s)}},x=()=>{o.first_name=a.value.first_name,o.last_name=a.value.last_name,d.value=!0},D=()=>{d.value=!1,m.value=null,m.value},M=()=>{b.value.click()},U=s=>{const t=s.target.files[0];if(t){if(t.size>2*1024*1024){r("حجم عکس نباید بیشتر از 2MB باشد","error");return}m.value=t;const u=new FileReader;u.onload=g=>{},u.readAsDataURL(t)}},A=async()=>{p.value=!0;try{const s=new FormData;s.append("first_name",o.first_name),s.append("last_name",o.last_name);const t=await C("site/active-user/edit-profile",{first_name:o.first_name,last_name:o.last_name});t.ok?(d.value=!1,m.value=null,r("پروفایل با موفقیت به‌روزرسانی شد","success"),y()):r(t.message||"خطا در به‌روزرسانی پروفایل","error")}catch(s){r("خطا در ارتباط با سرور","error"),console.error("Error updating profile:",s)}finally{p.value=!1}},r=(s,t="success")=>{z.fire({text:s,icon:t})},E=s=>{if(!s)return"";const t=new Date(s);return new Intl.DateTimeFormat("fa-IR",{year:"numeric",month:"long",day:"numeric"}).format(t)};return F(()=>{y()}),(s,t)=>{var u,g;return n(),i("div",H,[e("div",N,[e("div",R,[e("div",S,[e("div",q,[e("img",{src:f.value,alt:"Profile Picture"},null,8,T),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:M},[...t[2]||(t[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})],-1)])])]),e("input",{ref_key:"fileInput",ref:b,type:"file",class:"hidden",accept:"image/*",onChange:U},null,544)]),e("div",G,[e("h1",J,l(a.value.first_name)+" "+l(a.value.last_name),1),e("p",K,l(a.value.email),1),e("div",O,l(a.value.role),1)])])]),e("div",Q,[e("div",W,[e("div",X,[e("div",Y,[t[3]||(t[3]=e("h2",{class:"card-title text-2xl"},"جزئیات پروفایل",-1)),d.value?v("",!0):(n(),i("button",{key:0,class:"btn btn-primary",onClick:x}," ویرایش اطلاعات "))]),d.value?(n(),i("form",{key:1,onSubmit:L(A,["prevent"])},[e("div",ne,[e("div",re,[t[8]||(t[8]=e("label",{class:"label"},[e("span",{class:"label-text"},"نام")],-1)),k(e("input",{type:"text",placeholder:"نام خود را وارد کنید",class:"input input-bordered","onUpdate:modelValue":t[0]||(t[0]=h=>o.first_name=h),required:""},null,512),[[I,o.first_name]])]),e("div",ce,[t[9]||(t[9]=e("label",{class:"label"},[e("span",{class:"label-text"},"نام خانوادگی")],-1)),k(e("input",{type:"text",placeholder:"نام خانوادگی خود را وارد کنید",class:"input input-bordered","onUpdate:modelValue":t[1]||(t[1]=h=>o.last_name=h),required:""},null,512),[[I,o.last_name]])])]),e("div",de,[e("button",{type:"button",class:"btn btn-ghost",onClick:D},"انصراف"),e("button",{type:"submit",class:P(["btn btn-primary",{loading:p.value}])}," ذخیره تغییرات ",2)])],32)):(n(),i("div",Z,[e("div",$,[t[4]||(t[4]=e("div",{class:"stat-title"},"نام کامل",-1)),e("div",ee,l(a.value.first_name)+" "+l(a.value.last_name),1)]),(u=a.value)!=null&&u.mobile?(n(),i("div",te,[t[5]||(t[5]=e("div",{class:"stat-title"},"موبایل",-1)),e("div",se,l(a.value.mobile),1)])):v("",!0),(g=a.value)!=null&&g.email?(n(),i("div",ae,[t[6]||(t[6]=e("div",{class:"stat-title"},"ایمیل",-1)),e("div",oe,l(a.value.email),1)])):v("",!0),e("div",le,[t[7]||(t[7]=e("div",{class:"stat-title"},"تاریخ عضویت",-1)),e("div",ie,l(E(a.value.created_at)),1)])]))])])]),_.show?(n(),i("div",ue,[e("div",{class:P(["alert",_.type==="success"?"alert-success":"alert-error"])},[e("span",null,l(_.message),1)],2)])):v("",!0)])}}},ge=j(me,[["__scopeId","data-v-5d13c624"]]);export{ge as default};
